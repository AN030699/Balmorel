
SHARE_ST_EFF_TOTAL_EFF_CC=2/3
SHARE_GT_EFF_TOTAL_EFF_CC=1/3

GDATA(G,'RAMPING')$(GDATA(G,'TECHGROUP' EQ COMBINED_CYCLE))=GDATA('GASTURBINE_XXX','RAMPING')
GDATA(G,'EFFICIENCY')$(GDATA(G,'TECHGROUP' EQ COMBINED_CYCLE))=GDATA(G,'EFFICIENCY')*SHARE_ST_EFF_TOTAL_EFF_CC;


VGE_T_CC_GT(IY411,IA,IGCC,IS3,T)=L=SHARE_CAPACITY_GT*VUCON*GDATA(IGUC,'GDUCUNITSIZE')
VGE_T_CC_GT(IY411,IA,IGCC,IS3,T)=L=SHARE_CAPACITY_ST*VUCON*GDATA(IGUC,'GDUCUNITSIZE')

VGF_T(IY411,IA,IGCC,IS3,T)=VGE_T_CC_GT(IY411,IA,IGCC,IS3,T)/EFFICIENCY_GT
VGF_T_CC_GT(IY411,IA,IGCC,IS3,T)*(1-EFFICIENCY_GT) =G= VGE_T_CC_ST(IY411,IA,IGCC,IS3,T)*EFFICIENCY_ST
VGE_T(IY411,IA,IGCC,IS3,T)=VGE_T_CC_GT(IY411,IA,IGCC,IS3,T)+VGE_T_CC_ST(IY411,IA,IGCC,IS3,T)



$ifi not %SEASONALLINKUC%==yes $goto STEPWISERAMPING_SEASONLINK_END

QUCRAMPU_CC(IAGK_HASORPOT(IY411,IA,IGUC),S,T)$((1 GT CHRONOHOUR(S,T)*GDATA(IGUC,'GDUCRAMPU')) AND (NOT (ORD(S) EQ 1 AND (ORD(T) EQ 1))) AND IS3(S) AND GDATA(IGUC,'GDUCRAMPU'))..
* up gradient at t
-VGE_T_CC_ST(IY411,IA,IGUC,S-1,T--1)$(ORD(T) EQ 1) - VGE_T_CC_ST(IY411,IA,IGUC,S,T-1)$(NOT (ORD(T) EQ 1))
    + VGE_T_CC_ST(IY411,IA,IGUC,S,T)
         =L=
     (
* units under start up have an expanded gradient
         GDATA(IGUC,'GDUCGMIN')*VUCU(IY411,IA,IGUC,S,T)
* up gradient of units on at t excluding units under start up
        + GDATA(IGUC,'GDUCRAMPU')*(VUCON(IY411,IA,IGUC,S,T) - VUCU(IY411,IA,IGUC,S,T))
* scale unit input capacity
     )*(GDATA(IGUC,'GDUCUNITSIZE')/(1$((NOT IGESTO(IGUC)) AND (NOT IGESTOS(IGUC)) AND (NOT IGHSTO(IGUC)) AND (NOT IGHSTOS(IGUC))) + GDATA(IGUC,'GDSTOHUNLD')$(IGESTO(IGUC) OR IGESTOS(IGUC) OR IGHSTO(IGUC) OR IGHSTOS(IGUC)))
       *(1$(NOT GEFFRATE(IA,IGUC))+GEFFRATE(IA,IGUC))))*CHRONOHOUR(S,T)*SHARE_ST_EFF_TOTAL_EFF_CC

;



QUCRAMPD(IAGK_HASORPOT(IY411,IA,IGUC),S,T)$((1 GT CHRONOHOUR(S,T)*GDATA(IGUC,'GDUCRAMPD')) AND (NOT (ORD(S) EQ 1 AND (ORD(T) EQ 1))) AND IS3(S) AND GDATA(IGUC,'GDUCRAMPD'))..
* down gradient at t
 +VGF_T(IY411,IA,IGUC,S-1,T--1)$(ORD(T) EQ 1) + VGF_T(IY411,IA,IGUC,S,T-1)$(NOT (ORD(T) EQ 1))
    - VGF_T(IY411,IA,IGUC,S,T)
         =L=
     (
* units under shut down have an expanded gradient
         GDATA(IGUC,'GDUCGMIN')*VUCD(IY411,IA,IGUC,S,T)
* up gradient of units on at t excluding units under shutdown
        + GDATA(IGUC,'GDUCRAMPD')*VUCON(IY411,IA,IGUC,S,T)
* scale unit input capacity
     )*(GDATA(IGUC,'GDUCUNITSIZE')*(1+(1/GDATA(IGUC,'GDCB'))$IGBPR(IGUC))/(1$((NOT IGESTO(IGUC)) AND (NOT IGESTOS(IGUC)) AND (NOT IGHSTO(IGUC)) AND (NOT IGHSTOS(IGUC))) + GDATA(IGUC,'GDSTOHUNLD')$(IGESTO(IGUC) OR IGESTOS(IGUC) OR IGHSTO(IGUC) OR IGHSTOS(IGUC)))
       /(GDATA(IGUC,'GDFE')*(1$(NOT GEFFRATE(IA,IGUC))+GEFFRATE(IA,IGUC))))*CHRONOHOUR(S,T)
$include "../../base/addons/_hooks/qucrampd.inc"
;


$label  STEPWISERAMPING_SEASONLINK_END

$ifi %SEASONALLINKUC%==yes $goto STEPWISERAMPING_NOT_SEASON_LINK_END

QUCRAMPU(IAGK_HASORPOT(IY411,IA,IGUC),S,T)$((1 GT CHRONOHOUR(S,T)*GDATA(IGUC,'GDUCRAMPU')) AND (NOT (ORD(T) EQ 1)) AND IS3(S) AND GDATA(IGUC,'GDUCRAMPU'))..
* up gradient at t
- VGF_T(IY411,IA,IGUC,S,T-1)
    + VGF_T(IY411,IA,IGUC,S,T)

         =L=
     (
* units under start up have an expanded gradient
         GDATA(IGUC,'GDUCGMIN')*VUCU(IY411,IA,IGUC,S,T)
* up gradient of units on at t excluding units under start up
        + GDATA(IGUC,'GDUCRAMPU')*(VUCON(IY411,IA,IGUC,S,T) - VUCU(IY411,IA,IGUC,S,T))
* scale unit input capacity
     )*(GDATA(IGUC,'GDUCUNITSIZE')*(1+(1/GDATA(IGUC,'GDCB'))$IGBPR(IGUC))/(1$((NOT IGESTO(IGUC)) AND (NOT IGESTOS(IGUC)) AND (NOT IGHSTO(IGUC)) AND (NOT IGHSTOS(IGUC))) + GDATA(IGUC,'GDSTOHUNLD')$(IGESTO(IGUC) OR IGESTOS(IGUC) OR IGHSTO(IGUC) OR IGHSTOS(IGUC)))
       /(GDATA(IGUC,'GDFE')*(1$(NOT GEFFRATE(IA,IGUC))+GEFFRATE(IA,IGUC))))*CHRONOHOUR(S,T)
;



QUCRAMPD(IAGK_HASORPOT(IY411,IA,IGUC),S,T)$((1 GT CHRONOHOUR(S,T)*GDATA(IGUC,'GDUCRAMPD')) AND (NOT (ORD(T) EQ 1)) AND IS3(S) AND GDATA(IGUC,'GDUCRAMPD'))..
* down gradient at t
  + VGF_T(IY411,IA,IGUC,S,T-1)
    - VGF_T(IY411,IA,IGUC,S,T)
         =L=
     (
* units under shut down have an expanded gradient
         GDATA(IGUC,'GDUCGMIN')*VUCD(IY411,IA,IGUC,S,T)
* up gradient of units on at t excluding units under shutdown
        + GDATA(IGUC,'GDUCRAMPD')*VUCON(IY411,IA,IGUC,S,T)
* scale unit input capacity
     )*(GDATA(IGUC,'GDUCUNITSIZE')*(1+(1/GDATA(IGUC,'GDCB'))$IGBPR(IGUC))/(1$((NOT IGESTO(IGUC)) AND (NOT IGESTOS(IGUC)) AND (NOT IGHSTO(IGUC)) AND (NOT IGHSTOS(IGUC))) + GDATA(IGUC,'GDSTOHUNLD')$(IGESTO(IGUC) OR IGESTOS(IGUC) OR IGHSTO(IGUC) OR IGHSTOS(IGUC)))
       /(GDATA(IGUC,'GDFE')*(1$(NOT GEFFRATE(IA,IGUC))+GEFFRATE(IA,IGUC))))*CHRONOHOUR(S,T)
;

$ifi %STEPWISE_RAMPING_UC%==ramp_const_cost QUCRAMPING_DOWN_BALANCE (IY411,IA,IGUC,S,T)$((NOT (ORD(T) EQ 1))  AND IAGK_HASORPOT(IY411,IA,IGUC) AND IS3(S))..
$ifi %STEPWISE_RAMPING_UC%==ramp_const_cost SUM(RAMPING_RATE,VRAMPING_DOWN(IY411,IA,IGUC,RAMPING_RATE,S,T))
$ifi %STEPWISE_RAMPING_UC%==ramp_const_cost =G=
$ifi %STEPWISE_RAMPING_UC%==ramp_const_cost + VGF_T(IY411,IA,IGUC,S,T-1)
$ifi %STEPWISE_RAMPING_UC%==ramp_const_cost -  VGF_T(IY411,IA,IGUC,S,T)
$ifi %STEPWISE_RAMPING_UC%==ramp_const_cost ;

$ifi %STEPWISE_RAMPING_UC%==ramp_const_cost QUCRAMPING_DOWN_RATE_CAPABILITY (IY411,IA,IGUC,RAMPING_RATE,S,T)$((NOT (ORD(T) EQ 1)) AND IAGK_HASORPOT(IY411,IA,IGUC) AND IRAMPING_G_CAPABILITY_DOWN(IGUC,RAMPING_RATE) AND IS3(S))..
$ifi %STEPWISE_RAMPING_UC%==ramp_const_cost VRAMPING_DOWN(IY411,IA,IGUC,RAMPING_RATE,S,T)
$ifi %STEPWISE_RAMPING_UC%==ramp_const_cost =L=
$ifi %STEPWISE_RAMPING_UC%==ramp_const_cost VUCON(IY411,IA,IGUC,S,T)*IRAMPING_G_CAPABILITY_DOWN(IGUC,RAMPING_RATE)*(GDATA(IGUC,'GDUCUNITSIZE')*(1+(1/GDATA(IGUC,'GDCB'))$IGBPR(IGUC))/(1$((NOT IGESTO(IGUC)) AND (NOT IGESTOS(IGUC)) AND (NOT IGHSTO(IGUC)) AND (NOT IGHSTOS(IGUC))) + GDATA(IGUC,'GDSTOHUNLD')$(IGESTO(IGUC) OR IGESTOS(IGUC) OR IGHSTO(IGUC) OR IGHSTOS(IGUC)))
$ifi %STEPWISE_RAMPING_UC%==ramp_const_cost /(GDATA(IGUC,'GDFE')*(1$(NOT GEFFRATE(IA,IGUC))+GEFFRATE(IA,IGUC))))*CHRONOHOUR(S,T)
$ifi %STEPWISE_RAMPING_UC%==ramp_const_cost ;

$label  STEPWISERAMPING_NOT_SEASON_LINK_END